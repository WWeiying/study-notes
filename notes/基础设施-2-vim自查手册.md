#! https://zhuanlan.zhihu.com/p/664631358

## Vim自查手册

>持续更新

VI是Unix操作系统和类Unix操作系统中最通用的文本编辑器。

VIM编辑器是VI发展出来的一个性能更强大的编辑器，以颜色区分语法的正确性，方便程序设计，与VI完全兼容。

Vim 常用的模式有四种：

一般模式，复制、粘贴、删除，按`ESC`进入；

编辑模式，编辑文件内容，一般模式下按`i`/`a`/`o`/`I`/`A`/`O`进入；

命令模式，输入`:`进入；

### 移动

|          命令           | 作用                                                         |
| :---------------------: | :----------------------------------------------------------- |
|         k/j/h/l         | 上下左右移动光标                                             |
|           30j           | 向下移动30行                                                 |
|           :q!           | 强制退出文件，放弃所有改动                                   |
|           :wq           | 保存文件并退出                                               |
|           ZZ            | 无修改，则不保存退出；有修改，则保存退出。（保存后离开）     |
|            i            | 在光标前插入文本                                             |
|            a            | 在光标后插入文本                                             |
|            I            | 跳转到本行的第一个非空白字符                                 |
|            A            | 在一行后插入文本                                             |
|            o            | 在光标下方打开新的一行并进入插入模式                         |
|            O            | 在光标上方打开新的一行并进入插入模式                         |
|            r            | 输入r和一个字符替换光标所在位置的字符                        |
|            R            | 输入大写的R可连续替换多个字符，按`ESC`退出替换模式回到正常模式 |
|            x            | 删除光标所在位置的字符，向后删除一个字符                     |
|            X            | 向前删除一个字符                                             |
|           nx            | 连续向后删除n个字符                                          |
|           dw            | 从光标处删除至下一个单词的起始处（不包括下一个单词的第一个字符） |
|          d$/D           | 从当前光标删除到行尾                                         |
|           d0            | 从当前光标删除到行首                                         |
|           de            | 从光标处删除到当前单词末尾（包括当前单词的最后一个字符）     |
|           d2w           | 向前删除两个单词                                             |
|           dd            | 删除当前行                                                   |
|           2dd           | 删除（剪切）两行                                             |
|           d1G           | 删除光标处到第一行的所有数据                                 |
|           dG            | 删除光标处到最后一行的所有数据                               |
|           dw            |                                                              |
|           diw           |                                                              |
|           daw           |                                                              |
|           diW           |                                                              |
|           daW           |                                                              |
|           di”           |                                                              |
|           da”           |                                                              |
|        di(或di)         |                                                              |
|        da(或da)         |                                                              |
|                         | 对s(sentence)句子进行操作                                    |
|                         | 对p(paragraph)段落进行操作                                   |
|                         | 对t(tag)进行操作                                             |
|                         | 对‘ ’的内容进行操作                                          |
|                         | 对[ ]的内容进行操作                                          |
|                         | 对{ }内的内容进行操作                                        |
|                         | 对< >的内容进行操作                                          |
|          c2i{           | 在 a 和 i 前加上数字，对多个层文本对象进行操作               |
|            w            | 从光标处到下一个单词起始处，不包括下一个单词第一个字符       |
|            e            | 从光标处到当前单词的末尾，包括当前单词的最后一个字符         |
|           2w            | 光标向前移动两个单词                                         |
|           3e            | 光标向前移动到第三个单词的末尾                               |
|            0            | 移动光标到行首                                               |
|            $            | 从光标处到当前行末尾                                         |
|            ^            | 跳转到行首的第一个非空白字符                                 |
|           ESC           | 返回正常模式，撤销不想输入或者部分完整的命令                 |
|            u            | 撤消最后执行的命令                                           |
|            U            | 撤消对整行的修改                                             |
|         CTRL-R          | 撤消掉撤消命令，恢复之前的操作结果                           |
|            .            | 重复前一个操作                                               |
|            p            | 输入p将最后一次删除的内容置于光标之后                        |
|           p/P           | p将复制的数据粘贴在光标所在处下一行，P将复制的数据粘贴在光标所在处上一行 |
|            J            | 将当前行和下一行结合成同一行（两行合并）                     |
|            c            | 重复删除多个数据，10cj：向下删除10行                         |
|           cc            | 修改当前行                                                   |
|          cw/ce          | 要改变文本直到一个单词的末尾                                 |
|           c$            | 要改变文本直到当前行末尾，即删除到行尾然后进入插入模式       |
|            s            | 删除一个字符并进入插入模式                                   |
|            S            | 删除整行并进入插入模式                                       |
|         CTRL-G          | 显示当前编辑文件中当前坐标所在行位置以及文件状态信息         |
|            G            | 当前坐标直接跳转到文件最后一行的第一个字符                   |
|           gg            | 当前坐标直接跳转到文件第一行                                 |
|        CTRL+Home        | 跳转到文件的开头                                             |
|        CTRL+End         | 跳转到文件的结尾                                             |
|           (/)           | 跳转到上一句/下一句                                          |
|           {/}           | 跳转到上一段/下一段                                          |
|         行号+G          | 跳转到指定行                                                 |
|         1G36\|          | 跳转到第一行36列                                             |
|       59+右方向键       | 向右移动59个字符                                             |
|         H(igh)          | 移动到当前屏幕的第一行的第一个字符                           |
|        M(iddle)         | 移动到当前屏幕中间行的第一个字符                             |
|          L(ow)          | 移动到当前屏幕最后一行的第一个字符                           |
|         CTRL+e          | 向下滚动屏幕，滚动屏幕而不移动光标，Vim不允许光标在当前屏幕以外 |
|         CTRL+y          | 向上滚动屏幕                                                 |
|           zt            | 把当前行滚动到屏幕的顶部                                     |
|           zz            | 把当前行滚动到屏幕的中部                                     |
|           zb            | 把当前行滚动到屏幕的底部                                     |
|   数字+f(ind)/F+字符    | 在当前行内向下（上）搜索第几个指定的字符                     |
|      t(ill)/T+字符      | 在当前行内向下（上）搜索第几个指定的字符，f会包含这个字符，t不会包含这个字符 |
|         /字符串         | 在当前文件中向下搜索该字符串，查找到达文件末尾，自动从文件头部继续查找。n向下搜索该字符串，N向上搜索该字符串。 |
|        ？字符串         | 在当前文件中向上搜索该字符串                                 |
|        /或？选项        | 将搜索模式改为全字匹配模式，即在单词两侧加上 `\<`, `\>`。加上\c不区分大小写敏感。 |
|         CTRL-O          | 跳转到较旧的位置                                             |
|         CTRL-I          | 跳转到较新的位置                                             |
|            %            | 输入%查找 （、[、{ 配对的括号 ）、]、} ，再次输入%跳回配对的第一个括号处。 |
|       :s/old/new        | 替换光标所在行的第一个匹配串                                 |
|      :s/old/new/g       | 替换光标所在行的所有匹配串                                   |
|     :#,#s/old/new/g     | 替换#行和#行等若干行之间的所有匹配串                         |
|      :%s/old/new/g      | 替换整个文件的所有匹配串                                     |
|     :%s/old/new/gc      | 替换整个文件的所有匹配串，并且提示是否对每个匹配串进行替换   |
|       :!外部命令        | 在VIM内执行外部shell命令，如 :!ls获取当前目录的内容，命令以回车键结束 |
|          :!ls           | 用于显示当前目录的内容                                       |
|      :!rm FILENAME      | 用于删除名为FILENAME的文件                                   |
|       :w FILENAME       | 将对文件的改动保存到文件中（另存为）                         |
|        :!rm TEST        | 在Unix下，删除TEST文件                                       |
|  v motion :w FILENAME   | 在当前文件可视模式下将选中的部分内容保存到文件FILENAME中，提取文件 |
|    :n1,n2 w FILENAME    | 将n1到n2行间的内容保存到文件FILENAME中                       |
|       :r FILENAME       | 向当前文件光标所在位置后面插入另外的文件的内容，合并文件     |
|        :r !命令         | 向当前文件光标所在位置的下一行插入命令的输出                 |
|           yy            | 复制当前行                                                   |
|          20yy           | 复制光标处向下20行                                           |
|           y/p           | v进入可视模式，y复制选中的文本，j$跳到下一行末尾，p粘贴复制的文本 |
|           yw            | 复制一个单词                                                 |
|           y1G           | 复制光标所在行到第一行的所有数据                             |
|           yG            | 复制光标所在行到最后一行的所有数据                           |
|           y0            | 复制光标所在处到行首的所有数据                               |
|           y$            | 复制光标所在处到行尾的所有数据                               |
| :set ignorecase/:set ic | Ignore Case，设置忽略大小写                                  |
|        /ignore\c        | 仅在一次查找时忽略字母大小写（\c选项）                       |
|        :set noic        | 禁用忽略大小写                                               |
|    :nohlsearch/:noh     | 移除匹配项的高亮显示                                         |
| :set hlsearch/:set hls  | 设置匹配项的高亮显示                                         |
|  :set insearch/:set is  | 设置递进式搜索，随着输入字符更新搜索结果                     |
| :set formatoptions-=ro  | 下一行不自动续写注释符号                                     |
|       <F1>/:help        | 启动VIM的在线帮助系统<br />:help w<br/>        :help c_CTRL-D<br/>        :help insert-index<br/>        :help user-manual<br />:help vimrc-intro<br />:help cmd |
|         CTRL-W          | 在窗口之间跳转                                               |
|          vimrc          | :edit ~/.vimrc 编辑vimrc文件<br />:r $VIMRUNTIME/vimrc_example.vim 读取vimrc示例文件的内容<br />:write 保存文件 |
|        :set nocp        | 确保Vim不是在兼容模式                                        |
|    :e 文件名/CTRL-D     | 不退出vim，并打开当前目录下的文件，CTRL-D显示目录文件列表    |
|        :e <TAB>         | 不退出vim，并打开当前目录下的文件，<TAB>切换要打开的文件名   |
|          <TAB>          | Vim会补全文件名（如果是唯一匹配）                            |
|     CTRL+f(orward)      | 向下翻页                                                     |
|     CTRL+b(ackward)     | 向上翻页                                                     |
|       CTRL+d(own)       | 向下翻半页                                                   |
|        CTRL+u(p)        | 向上翻半页                                                   |
|            +            | 光标移动到非空格符的下一行                                   |
|            -            | 光标移动到非空格符的上一行                                   |
|        n<space>         | 光标向右移动n个字符                                          |
|        n<Enter>         | 光标向下移动n行                                              |
|       :! command        | 在vim中暂时执行命令行指令                                    |
|    :100,105 norm gUU    | 将 100 行到 105 行之间的所有字母转换为大写                   |

### Visual Block

|    命令   | 作用 |
| :----------------------------------: | :----------------------------------------------------------- |
|            v            |                           字符选择                           |
|            V            |                            行选择                            |
|         Ctrl+v          |                      可视区块，矩形选择                      |

### 多文件编辑

|          命令           | 作用                                                         |
| :---------------------: | :----------------------------------------------------------- |
| vim filename1 filename2 | 同时打开两个文件                                             |
|          :args          | 文件列表命令，显示参数列表（正在编辑的文件列表），方括号标识了当前编辑的文件 |
|     :args filename      | 使用新的文件名替换参数列表                                   |
|     :first/:rewind      | 编辑列表的第一个文件                                         |
|          :last          | 编辑列表的最后一个文件                                       |
|         :n(ext)         | 编辑下一个文件                                               |
|   :N(ext)/:prev(ious)   | 编辑上一个文件                                               |
|           :e#           | 回到刚才编辑的文件                                           |
|         :files          | 列出这个vim开启的所有文件                                    |
|     :n\|normal ggP      | 切换到下一个文件并执行正常模式命令ggP，跳转到文件开头并贴入文本 |

### 缓冲区命令

|         **命令**          | %a表示当前活跃的文件，#表示最近的缓冲区        |
| :-----------------------: | :--------------------------------------------- |
|       :buffers/:ls        | 显示缓冲区的列表                               |
| :b(uffer) 缓冲区列表编号  | 跳转到编号对应的缓冲区                         |
| :b(delete) 缓冲区列表编号 | 删除编号对应的缓冲区，省略编号则删除当前缓冲区 |
|         :bn(ext)          | 跳转到下一个缓冲区                             |
|         :b(Next)          | 跳转到上一个缓冲区                             |
|       :bp(revious)        | 跳转到上一个缓冲区                             |
|        :bfirst/:b1        | 跳转到缓冲区列表的第一个文件                   |
|         :brewind          | 跳转到缓冲区列表的第一个文件                   |
|          :blast           | 跳转到缓冲区列表的最后一个文件                 |
|          CTRL+^           | 在最近的两个缓冲区之间来回切换                 |

### 多窗口操作

|          命令          | 作用                                                       |
| :--------------------: | :--------------------------------------------------------- |
|        CTRL+w+n        | 打开一个新窗口                                             |
|   :sp(lit)/CTRL+w+s    | 水平划分窗口                                               |
|   :vs(plit)/CTRL+w+v   | 垂直划分窗口                                               |
|   CTRL+w+q/:close/:q   | 关闭所在的窗口，当前窗口是最后一个窗口则退出Vim            |
|        CTRL+w+c        | 关闭所在的窗口，当前窗口是最后一个窗口则无效               |
|   CTRL+w+h/l/j/k/w/W   | 同时按下CTRL+w后放开，再按下方向键后松开，即可切换窗口     |
|       CTRL+w+__        | 设置窗口高度，命令前的数字表示窗口高度行数，默认为纵向占满 |
|       CTRL+w+\|        | 设置窗口宽度，命令前的数字表示窗口宽度行数，默认为横向占满 |
|    CTRL+w+=/-/+/</>    | 窗口均等/高度减小/高度增加/宽度减小/宽度增加               |
|     :res(ize) num      | 显示行数调整为num行                                        |
|     :res(ize)+num      | 把当前窗口高度增加num行                                    |
|     :res(ize)-num      | 把当前窗口高度减少num行                                    |
| :vertical res(ize) num | 指定当前窗口为num列                                        |
| :vertical res(ize)+num | 把当前窗口增加num列                                        |
| :vertical res(ize)-num | 把当前窗口减少num列                                        |
|   vim -o file1 file2   | 水平打开多窗口                                             |
|   vim -O file1 file2   | 垂直打开多窗口                                             |

### 比较文件差异

| 命令 | 作用 |
| :----------------------------------: | :----------------------------------------------------------- |
|          vim -d file1 file2          |                 垂直打开多窗口,并且进行比较                  |
| vimdiff/gvimdiff filename1 filename2 |                      对两个文件进行比较                      |
|      :vert diffsplit filename2       |         在Vim内部打开第二个文件，与当前文件进行比较          |
| ]c | 跳到下一个差异处 |
| [c | 跳到上一个差异处 |
| do | 将当前差异的内容合并到当前文件 |
| dp | 将当前差异的内容合并到另一个文件 |
| :diffupdate | 更新差异，查找新的差异 |
| :diffthis | 在每个分屏中启用比较模式 |
| :diffoff | 如果需要关闭比较模式，可以在每个分屏中输入 |

### 折叠

| 命令 | 作用 |
| :----------------: | :-------------------------------------------------------- |
|         zf         | `zf3j` 将折叠当前行及其下面的三行/`ggVG`+`zf`折叠整个文件 |
|         zo         |                       展开当前折叠                        |
|         za         |        切换折叠状态，展开当前折叠或者关闭当前折叠         |
|         zR         |                       展开所有折叠                        |
|         zM         |                       关闭所有折叠                        |
| zj /z<Enter>。 |                     移动到下一个折叠                      |
|    zk /z-   |                     移动到上一个折叠                      |



|命令|作用|
| :----------------------------------: | :----------------------------------------------------------- |
|             :Ex/:e ./:E              |   开启目录浏览器，可以浏览当前目录下的所有文件，并可以选择   |
|             :vs ./vsp .              |        垂直分割当前窗口，并在一个窗口中开启目录浏览器        |
|                 :Sex                 |        水平分割当前窗口，并在一个窗口中开启目录浏览器        |

### 多标签页操作

|                 命令                 | 作用                                       |
| :----------------------------------: | :----------------------------------------- |
|              :tabsnew .              | 在新标签页打开目录树                       |
|              :tab help               | 在新标签页打开帮助                         |
|              :tab split              | 在新标签页打开当前缓冲区                   |
|                :tabs                 | 展示所有标签页的结果                       |
|          :tabsnew/:tabsedit          | 打开一个空白新标签页，有文件名则打开该文件 |
|          :tabclose/CTRL+w+c          | 关闭当前标签页                             |
|      :tabnext/gt/CTRL+PageDown       | 切换到下一个标签页                         |
| :tabNext/gT/CTRL+PageUp/:tabprevious | 切换到上一个标签页                         |
|         :tabfirst/:tabrewind         | 切换到第一个标签页                         |
|               :tablast               | 切换到最后一个标签页                       |
|               CTRL+W+T               | 将当前窗口转换为一个新标签页               |

### 终端窗口的调用

|          命令          | 作用                                                         |
| :--------------------: | :----------------------------------------------------------- |
|      :term(ianl)       | 新建水平窗口，打开命令终端                                   |
| :vertical :term(inal)  | 新建垂直窗口，打开命令终端                                   |
|          exit          | 退出命令终端窗口                                             |
| CTRL+反斜杠+N/CTRL+W+N | 将从Terminal-Job模式切换至Terminal-Normal模式，按 i 则回到Terminal-Job模式 |

### 重复操作

| 命令 | 作用                                       |
| :--: | :----------------------------------------- |
|  ；  | 重复最近的字符查找操作（f/t等）            |
|  ，  | 重复最近的字符查找操作（f/t等），反方向    |
|  n   | 重复最近的字符串查找操作（/和?等）         |
|  N   | 重复最近的字符串查找操作（/和?等），反方向 |
|  .   | 重复执行最近的修改操作                     |
|  gd  | 高亮显示所有相同的单词                     |
|  *   | 向下查找相同单词并高亮显示                 |
|  #   | 向上查找相同单词并高亮显示                 |

### 插件命令

|                 命令                 | 作用                                             |
| :----------------------------------: | :----------------------------------------------- |
|           **NERDTREE插件**           |                                                  |
|                  o                   | 在已有窗口中打开文件、目录或书签，并跳到该窗口   |
|                  go                  | 在已有窗口中打开文件、目录或书签，但不跳到该窗口 |
|                  t                   | 在新 Tab 中打开选中文件/书签，并跳到新 Tab       |
|                  T                   | 在新 Tab 中打开选中文件/书签，但不跳到新 Tab     |
|                  i                   | split 一个新窗口打开选中文件，并跳到该窗口       |
|                  gi                  | split 一个新窗口打开选中文件，但不跳到该窗口     |
|                  s                   | vsplit 一个新窗口打开选中文件，并跳到该窗口      |
|                  gs                  | vsplit 一个新 窗口打开选中文件，但不跳到该窗口   |
|                  !                   | 执行当前文件                                     |
|                  O                   | 递归打开选中 结点下的所有目录                    |
|                  m                   | 文件操作：复制、删除、移动等                     |
|  :tabnew [++opt选项] ［＋cmd］ 文件  | 建立对指定文件新的tab                            |
|                :tabc                 | 关闭当前的 tab                                   |
|                :tabo                 | 关闭所有其他的 tab                               |
|                :tabs                 | 查看所有打开的 tab                               |
|               :tabp/gT               | 前一个 tab                                       |
|               :tabn/gt               | 后一个 tab                                       |
|            **ctags插件**             |                                                  |
|              ctags -R .              | 递归生成当前目录及子目录的tags                   |
| ctags -R --languages=SystemVerilog . | 指定文件类型递归生成当前目录及子目录的tags       |
|         ctags -a newfile.sv          | 追加单个文件                                     |
|  ctags -a --update modified_file.sv  | 更新修改的文件                                   |
|                ctrl+]                | 查看函数定义                                     |
|                Ctrl+o                | 返回原来文件                                     |
|                Ctrl+t                | 原路返回                                         |
|                  gf                  | 查看头文件                                       |
|                  gd                  | 转到当前光标所指的局部变量的定义处。             |
|          :tag function_name          | 查找标签                                         |
|        :tselect function_name        | 多个匹配                                         |
|                 :tn                  | 跳转到下一个匹配                                 |
|                 :tp                  | 跳转到上一个匹配                                 |
|             :TlistToggle             | 显示函数列表，再来一次关闭                       |
|        :TlistOpen/TlistClose         | 打开关闭函数列表                                 |
|               ctrl＋ww               | 在列表和源文件中切换                             |
|            :help helptags            | 查看帮助文件                                     |
|          :help taglist.txt           | 查看帮助文件                                     |
|                  u                   | 在Taglist窗口刷新！或者用：TlistUpdate           |

### 快捷命令 

|           命令           | 作用                                                         |
| :----------------------: | :----------------------------------------------------------- |
|       :%s/\s\+$//g       | 去除文件中每一行末尾的空格（包括空格、制表符等）             |
| 禁用自动注释（临时方案） | 在粘贴前，先进入paste模式，这会禁用所有自动格式化（包括注释）：<br />:set paste       " 进入粘贴模式 <br />i                " 进入插入模式后粘贴内容<br /> <Esc>            " 退出插入模式<br /> :set nopaste     " 退出粘贴模式 |
